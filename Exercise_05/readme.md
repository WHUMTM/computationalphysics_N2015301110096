# 第二章作业2

标签： 计算物理作业 苗泰民 2015301110096 

---

# 第二章习题


------

[toc]









-----


##摘要


棒球运动作为一项妙趣横生的球类运动，即古老，又生机盎然。它源于英国发展于美国，并作为美国的“国球”，为大众所喜爱。棒球运动由于其极具竞技性和观赏性，同时其运动状态非常有趣，广为物理学家所喜欢，为棒球运动所写的专著文献数不胜数.
本文选取`problem 2.9`作为习题，研究棒球运动的运动轨迹，并尽可能分析环境作用对棒球运动的影响，以还原出真实的棒球运动.
棒球运动和前一节的作业`problem 2.9 projectile motion`类似，本质上还是抛体运动，但与前例的`canon`不同，我们不仅要研究落点的远近问题，同样还要考虑球本身形状，粗糙度，自旋等影响因素，同时考虑棒球运动轨迹对球员的影响，种种影响使得棒球运动的物理过程变得及其复杂，在使用计算机模拟时，无法做到各方面模拟全都包涵其中，也没用必要包涵其中，本文仅就提高棒球游戏观赏性为目标，结合影响棒球的主要因素，利用`Euler method`还原一个完整的棒球比赛的物理过程.



----------


##背景
> **Model the effect of backspin on the range of a batted ball. Assume an angular valocity of 2000 rpm.** 

----------
##主要内容
###1、棒球运动简介与物理模型
####棒球运动简介
棒球运动包含2方阵营，每方9人。其中最具技巧性，同时也与我们讨论相关的2个队伍的灵魂人物 `picher` 和 `batter`，而与本文讨论最为密切的两个动作即投球和击球（当然诸如跑垒等动作也需要分析空气的原因，但是我不认为棒球教练愿意花大价钱分析空气阻力对运动员奔跑的影响），同时这也是棒球比赛最具观赏性的部分——投手与击球手的博弈。然而我们最希望看到的要么是投手投出诸如`knuckleball`等极具迷幻的球，要么就是击球手打出`home run`当然这两种动作我们之后会看到，都是非常不容易的。那么，为了增加观赏性，我们需要分析那些环境因素呢。在此之前，先来分析一下棒球运动的运动方程.

-----
####理想物理模型
与抛体运动相同，当忽略空气阻力和大气密度变化等一切外界因素，理想化的模型可以用如下方程描述
\begin{cases}
\frac{d^2x}{dt^2}&=0   &&\tag1\\
\frac{d^2y}{dt^2}&=-g 
\end{cases}
其中g是重力加速度，$x$ 和 $y$ 分别表示炮弹的水平和垂直的坐标。这是一个二阶常微分方程，并不难求解.

---
####空气阻力
加入考虑空气阻力时，由于空气阻力可以由如下方程得到

$$F_{drag}=-B_2v^2\tag2$$

其中$v=\sqrt{v_x^2+v_y^2+v_z^2}$，由矢量分析可以得到阻力的各分量式
$$\begin{cases}
F_{drag,x}=-B_2\ v\ v_x\\
F_{drag,y}=-B_2\ v\ v_y\\
F_{drag,z}=-B_2\ v\ v_z\tag3
\end{cases}$$
这个结论与之前抛体相同，但是由于棒球并不是一个理想的球，由于历史原因，棒球表面有缝合的线，其真实的形状如下图所示：
![](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1508524500812&di=e3cf986cc2ca3529b37c66febc0f694f&imgtype=0&src=http%3A%2F%2Fpic1.win4000.com%2Fwallpaper%2Fb%2F592008772ff36.jpg)
然而，参数 $B_2$ 与物体表面的粗糙程度和物体速度有关，根据教材中`figure 2.6`可以得到一个实验上的近似公式
$$\frac{B_2}{m}= \ 0.0039\ +\ \frac{0.0058}{1\ +\ exp[(v-v_d)/\Delta]}\tag4$$
其中，$v_d=35 \ m/s$, $\Delta=5\ m/s$, 与实验结果相对应.
当然，实际上还要考虑风阻的影响，但是由于风阻具有较大的随机性，同时我们知道当顺风的时候，球可以飞的更远，逆风时相反，相对其他因素，风阻相对简单，同时随机性较大，且对球运动的影响处于次要因素，同时考虑风阻后，空气阻力可以修改为

$$\begin{cases}
F_{drag,x}&=\ -B_2\ | v-v_{wind}|\ (v_x-v_{wind})\\
F_{drag,y}&=\ -B_2\ | v-v_{wind}|\ v_y\\
F_{drag,z}&=\ -B_2\ | v-v_{wind}|\ v_z\tag3
\end{cases}$$

其中，为了简便，假定风向沿x轴方向.
这可完全由定义较小的初速度近似，因而，在模拟时忽略风阻的影响.
至于空气的其他因素，诸如空气密度不均匀，空气湿度等更小因素对球运动的影响，本模拟过程中暂不考虑.

---
####自旋
加入考虑自旋的影响时，此时加入了`Magnus force` 的影响.
其形成原因也是由于棒球表面相对粗糙，导致空气流动时在球的表面产生了气流的湍流，同时由于自旋的原因导致与球运动垂直的两个面表面的速度不相同，因而在这2个面产生的力大小不相同，因而产生一个不为0的净力指向速度较小的那个面。
其`Magnus force`表达式可以由如下近似

$$\vec{F}_M=S_0\vec{v}\ \times\ \vec{\omega}\tag5$$
这里$S_0$ 是比例系数，由实验测定近似为$S_0/m4.1\times10^{-4}$ 其中$m=149g$ 与实际的棒球相对应.
至此我们分析了大气对做抛体运动的主要的力学影响，此时棒球运动的表达式可由如下形式表达：
\begin{cases}
\frac{dx}{dt}&=v_x\\
\frac{dv_x}{dt}&=a_x=-\frac{B_2}{m}vv_x + \frac{S_0}{m}(\omega_yv_z-\omega_zv_y ) \\
\frac{dy}{dt}&=v_y\\
\frac{dv_y}{dt}&=a_y=-g-\frac{B_2}{m}vv_y + \frac{S_0}{m}(\omega_zv_x-\omega_xv_z )  \tag6\\
\frac{dz}{dt}&=v_z\\
\frac{dv_z}{dt}&=a_z=-\frac{B_2}{m} v v_{z}+ \frac{S_0}{m}(\omega_xv_y-\omega_yv_x ) 
\end{cases}
很显然这个方程并不好求出其解析解，然而下面我们会发现使用数值解可以轻松解决这个方程组，同时对于此例，数值解不仅一致收敛，同时误差很小.


--------
    
###2、程序源代码与计算

- 源代码[请点击这里](https://github.com/WHUMTM/computationalphysics_N2015301110096/blob/master/Exercise_05/Exercise_05_code.py)

------

###4、运行结果与分析
根据教材提供的与实际接近的数据，投手投掷时，其初速度平均约为49m/s，而击球手击球后初速度略大，大约可以达到55m/s，同时估计运动员身高平均值约为1.8m，这样其投掷出手时高度约为1.6m，本文按照这样的条件计算.

####对于击球手

 我们都希望击球手的每次击球都能打出本垒打，然而以49m/s的初速度高速移动，且运动轨迹变化多端的球，人类要预判其位置，实现精准打击已实属不易。同时，从下文可以看出，没有任何自旋的球要比没有自旋的球更加有利于飞行，打出`home run`，因而，要尽可能的打击球的正中心，然而，和前例一样，究竟什么样的出射角度，会使得球飞的更远，这是击球手首先要确定的事情，为此，结果如下：

![图1](https://raw.githubusercontent.com/WHUMTM/computationalphysics_N2015301110096/master/Exercise_05/1.png)
由曲线可以看出，当角度$\theta=43^{\circ}$左右，略小于$\theta=45^{\circ}$时，球的飞行距离最远.
因而，对于击球手，一个最基本的原则就是预判球的位置，沿略小于$\theta=45^{\circ}$的方向，在球的中心区域击打.

--------

####对于投掷手
投掷手的动作要领要比击球手复杂的多，同时其操纵球的手法也更加多变，可以使得球的运动路线复杂多变。这是一个很显然的结论，因为作为防守方，如果投出来的时直勾勾的球，击球手很好预判其位置，打出本垒打或超远球，那么教练员肯定会当场气的把帽子摔到地上.然而，要做到尽可能的复杂多变，球的自旋，是一个极为重要的变量.
先考虑球的自旋方向与x轴平行.
结果如下
![图5](https://raw.githubusercontent.com/WHUMTM/computationalphysics_N2015301110096/master/Exercise_05/x.png)
可以看出此时，相对平直球，的确是增加了一些变化，但是角速度不能太大，否则就成了`坏球`,同样影响成绩，因而需要尽可能小的角速度，却因此增加了一些变化。同时沿x轴方向的角速度，证实了对于击球手来说，没有任何自旋的球要比没有自旋的球更加有利于飞行，打出`home run`，因而，要尽可能的打击球的正中心。所以这是一个对双方都有利的角速度.

------

现考虑球的自旋方向与z轴平行

结果如下
![图6](https://raw.githubusercontent.com/WHUMTM/computationalphysics_N2015301110096/master/Exercise_05/z.png)
![图6](https://raw.githubusercontent.com/WHUMTM/computationalphysics_N2015301110096/master/Exercise_05/3.1.png)
这个方向的自旋的确是在y方向显示出了诡异的运动路线，但是对于方向，它没有任何的贡献，依然是平直球.因而，这种自旋没有太大作用，应在投掷时尽量避免这类自旋.

------

最后考虑球的自旋方向与y轴平行

结果如下
![图6](https://raw.githubusercontent.com/WHUMTM/computationalphysics_N2015301110096/master/Exercise_05/y.png)
由图像可以看出，这个方向的自旋导致z和y方向上都有诡异多端的运动路线变化，而且变化幅度最大，路线最为诡异多变，应当在投掷过程中尽可能多的投掷这类球，但是由于，变化幅度更大，因而需要更小的角速度.





----------


##结论
- 对于击球手，一个最基本的原则就是预判球的位置，沿略小于$\theta=45^{\circ}$的方向，在球的中心区域击打.
- 对于投掷手，应当在投掷过程中尽可能多的增加沿y方向的自旋角速度，尽可能避免沿z方向的自旋角速度，同时角速度不能太大，否则就成了`坏球`,同样影响成绩，需要投掷出尽可能小的角速度，以增加一下变化.


----------


##参考文献与鸣谢
[1]: 画图部分程序，参考[matplotlib source code](https://matplotlib.org/examples/lines_bars_and_markers/line_demo_dash_control.html). 
[2]: 算法部分参考 "Computational Physics" by Nicholas J. Giordano & Hisao Nakanishi.
[3]: [常用数学符号的LaTex表示方法](http://www.mohu.org/info/symbols/symbols.htm).
[4]: 棒球运动简介[参考](https://en.wikipedia.org/wiki/Baseball)
 






